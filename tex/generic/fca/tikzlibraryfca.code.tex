%%
%% This is file `tikzlibraryfca.code.tex',
%% generated with the docstrip utility.
%%
%% The original source files were:
%%
%% latex-fca.dtx  (with options: `tikz,package')
%%  latex-fca.dtx
%%  Copyright ℂ 2022 Ernst-Schröder-Zentrum
%%                   für Begriffliche Wissensverarbeitung
%%  Authors: Bernhard Ganter
%%           Tobias Schlemmer
%% 
%%  This program is provided under the terms of the
%%  LaTeX Project Public License distributed from CTAN
%%  archives in directory macros/latex/base/lppl.txt.
%% 
%%  This work is "maintained" (as per LPPL maintenance status) by
%%  Tobias Schlemmer <keinstein@users.sf.net>.
%% 
%%  This work consists of the files
%%    latex-fca.dtx and
%%    latex-fca.ins
%% 
%%  and the derived files
%%    fca.sty,
%%    formula0.cxt,
%%    formula1.cxt.
%% 
%% \CharacterTable
%%  {Upper-case    \A\B\C\D\E\F\G\H\I\J\K\L\M\N\O\P\Q\R\S\T\U\V\W\X\Y\Z
%%   Lower-case    \a\b\c\d\e\f\g\h\i\j\k\l\m\n\o\p\q\r\s\t\u\v\w\x\y\z
%%   Digits        \0\1\2\3\4\5\6\7\8\9
%%   Exclamation   \!     Double quote  \"     Hash (number) \#
%%   Dollar        \$     Percent       \%     Ampersand     \&
%%   Acute accent  \'     Left paren    \(     Right paren   \)
%%   Asterisk      \*     Plus          \+     Comma         \,
%%   Minus         \-     Point         \.     Solidus       \/
%%   Colon         \:     Semicolon     \;     Less than     \<
%%   Equals        \=     Greater than  \>     Question mark \?
%%   Commercial at \@     Left bracket  \[     Backslash     \\
%%   Right bracket \]     Circumflex    \^     Underscore    \_
%%   Grave accent  \`     Left brace    \{     Vertical bar  \|
%%   Right brace   \}     Tilde         \~}
\NeedsTeXFormat{LaTeX2e}[1999/12/01]
\ProvidesFile{tikzlibraryfca.code.tex}
    [2022/09/17 v3.0
 TikZ support for Formal concept Analysis]
\RequirePackage{fca}
\let\fca@tikz@without@library\relax
\def\fca@generate@tikz@parameter#1#2#3{%
  \pgfkeysdef{/fca/#1}{\pgfkeys{/tikz/#1=##1}}
  \pgfkeyssetvalue{/fca/#1}{#3}%
}
\fca@generate@tikz@parameters
\@for \@tempa:=%
shape,
text ragged,%
text badly ragged,%
text ragged left,%
text badly ragged left,%
text justified,%
text centered,%
text badly centered,%
even odd rule,%
nonzero rule,%
fill opacity,%
opacity,%
blend mode,%
color,%
rotate,%
solid,%
dotted,%
loosely dotted,%
densely dotted%
\do {
  \edef\@tempb{%
    \noexpand\pgfkeysdef{/fca/\@tempa}{\noexpand\pgfqkeys{/tikz}{\@tempa={##1}}}%
  }%
  \@tempb
}
\pgfkeysdef{/fca/options}{\tikz@addoption{#1}}
\pgfkeysdef{/fca/stroke}{%
  \pgfqkeys{/tikz}{draw={#1}}%
  \fca@testoption{#1}{%
    \fca@append\fca@usepath{stroke,}%
  }{}{%
    \fca@append\fca@usepath{stroke,}%
  }%
}
\pgfkeysdef{/fca/fill}{%
  \pgfqkeys{/tikz}{fill={#1}}%
  \fca@testoption{#1}{%
    \fca@append\fca@usepath{fill,}%
  }{}{%
    \fca@append\fca@usepath{fill,}%
  }%
}
\def\fca@options{\tikz@options}%
\def\fca@defaultoptions{\tikz@options}%
\def\fca@transform{\tikz@transform}%
\@ifundefined{tikz@transform}{\let\tikz@transform\empty}{}
\let\fca@ifintikz\@secondoftwo
\tikzaddtikzonlycommandshortcutlet\fca@ifintikz\@firstoftwo
\fcaset{%
  attributes left/.append style={
    align=flush right
  },
  attributes center/.append style={
    align=flush center
  },
  attributes right/.append style={
    align=flush left
  },
  objects left/.append style={
    align=flush right
  },
  objects center/.append style={
    align=flush center
  },
  objects right/.append style={
    align=flush left
  }
}

\let\fca@notikz@parse@paren@vector\fca@parse@paren@vector
\newcommand\fca@tikz@parse@paren@vector[3]{%
  \def\tikz@coordinate@caller{%
    \fca@notikz@parse@paren@vector{#1}{#2}{#3}%
  }%
  \tikz@scan@one@point \tikz@@coordinate@at@math
}

\newcommand\fca@tikz@oldnode[4]{%
  \begin{pgfscope}%
    \fca@nodeslayer
    \path (#3,#4) node[
      anchor=center,
      shape=circle,
      /fca/.cd,
      /fca/every node/.try,
      /fca/every concept/.try,
      #1]
      (#2) {} ;%
    \fca@endnodeslayer
    \ifthenelse{\boolean{fca@CircledNumbers}}{%
      \fca@nodenumberslayer
      \path (#2)
        node[
        shape=circle,
        anchor=center,
        /fca/.cd,
        /fca/every node/.try,
        /fca/every concept/.try,
        #1
        /fca/.cd,
        /fca/node number,
        draw=none]%
        (#2 number)
        {#2};%
      \fca@endnodenumberslayer
    }{}%
  \end{pgfscope}%
  \ignorespaces
}
\newcommand{\fca@tikz@oldedge}[3]{%
  \fca@edgeslayer
  \path[draw,/fca/.cd,#1] (#2) -- (#3);%
  \fca@endedgeslayer
  \ignorespaces
}

\newcommand\fca@tikz@labelBox[1]{%
  \begin{scope}%
    \fcaset{every node/.try,every label/.try,#1}%
    \edef\@tempa{\pgfkeysvalueof{/fca/pgfnode}}%
    \xdef\fca@temp@node@name{%
      \expandafter\fca@remove@anchor\expandafter{\@tempa}%
    }%
    \fca@labelslayer
      \path[/fca/.cd,every node/.try,every label/.try,#1]
      (\fca@temp@node@name.\fca@label@at)
      ++(\fca@label@shift@x,\fca@label@shift@y)
      node[shape=rectangle] (%
        \pgfkeysvalueof{/fca/label/name prefix}%
        \pgfkeysvalueof{/fca/node}%
        \pgfkeysvalueof{/fca/label/name suffix}%
      ){%
        \pgfkeysvalueof{/fca/node contents}%
      };%
    \fca@endlabelslayer
    \iffca@connectors
      \begin{scope}
        \fca@connectorslayer
        \path[draw,/fca/.cd,#1,every label edge/.try,/tikz/.cd]
        (\pgfkeysvalueof{/fca/node}) --
        (%
        \pgfkeysvalueof{/fca/label/name prefix}%
        \pgfkeysvalueof{/fca/node}%
        \pgfkeysvalueof{/fca/label/name suffix}%
        .\pgfkeysvalueof{/fca/anchor}) ;
        \fca@endconnectorslayer
      \end{scope}%
    \fi
    \begin{scope}
      \fcaset{shape=coordinate,#1}%
      \fcaset{%
        every label concept/.try}%
      \fcaset{%
        label concept/.try
      }%
      \def\@tempa{coordinate}%
      \ifx\@tempa\tikz@shape
      \else
        \fca@labelconceptslayer
        %\edef\fca@tempa{
        \path
          (\fca@temp@node@name.\fca@label@at)%
          node[draw,
          /fca/.cd,
          shape=coordinate,
          #1,
          every label concept/.try,
          label concept/.try]
        (\pgfkeysvalueof{/fca/label/name prefix}%
          \pgfkeysvalueof{/fca/node}%
          \pgfkeysvalueof{/fca/label/name suffix}%
          ){};
        % \pgfsetstrokecolor{\fca@node@color}%
        %\pgfnode{}{\pgfkeysvalueof{/fca/anchor}}{}{}%
        \fca@endlabelconceptslayer
      \fi
    \end{scope}
  \end{scope}%
  \ignorespaces
}
\newcommand\fca@tikz@startdiagram[1][]{%
  \fca@notikz@startdiagram%
  \fca@tikz@diagram@
}
\newcommand\fca@tikz@Defaults{
  \fca@notikz@Defaults
  \pgfkeysgetvalue{/tikz/name prefix}{\fca@tikz@origprefix}%
  \pgfkeysgetvalue{/fca/name prefix}{\@tempb}%
  \let\@tempa\fca@tikz@origprefix
  \fca@concat\@tempa\@tempb%
  \pgfqkeys{/tikz}{%
    name prefix/.expand once=\@tempa
  }%
  \pgfkeysgetvalue{/fca/name suffix}{\@tempa}%
  \pgfkeysgetvalue{/tikz/name suffix}{\@fca@tikz@origsuffix}%
  \fca@concat\@tempa\@fca@tikz@origsuffix%
  \pgfqkeys{/tikz}{%
    name suffix/.expand once=\@tempa
  }%
  \pgfkeyssetvalue{/fca/name prefix}{%
    \pgfkeysvalueof{/tikz/name prefix}%
  }%
  \pgfkeyssetvalue{/fca/name suffix}{%
    \pgfkeysvalueof{/tikz/name suffix}%
  }%
}
\tikzaddtikzonlycommandshortcutlet\fca@oldnode\fca@tikz@oldnode
\tikzaddtikzonlycommandshortcutlet\fca@oldedge\fca@tikz@oldedge
\tikzaddtikzonlycommandshortcutlet\fca@@labelBox\fca@tikz@labelBox
\tikzaddtikzonlycommandshortcutlet\fca@parse@paren@vector\fca@tikz@parse@paren@vector
\tikzaddtikzonlycommandshortcutlet\fca@notikz@Defaults\fca@Defaults
\tikzaddtikzonlycommandshortcutlet\fca@Defaults\fca@tikz@Defaults
\newenvironment{tikzdiagram}[1][]{%
  \def\fca@begindiagram{%
    \begin{tikzpicture}%
      \fcaset{#1}%
      \unitlength=\dimexpr\pgf@xx+\pgf@yx\relax
    }%
    \noindent
    \@ifnextchar\bgroup\fca@olddiagram\fca@diagram% This line must be
    % executed before \begin{pgfpicture}
  }{%
  \end{tikzpicture}%
}
\endinput
%%
%% End of file `tikzlibraryfca.code.tex'.
